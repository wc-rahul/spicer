{% style %}
@media(min-width:992px){
    .padding_{{ section.id }}{
        padding-top:{{section.settings.padding_top}}px;
        padding-bottom:{{section.settings.padding_bottom}}px;
    }
}
@media(max-width:991px){
    .padding_{{ section.id }}{
        padding-top:{{section.settings.padding_top_mob}}px;
        padding-bottom:{{section.settings.padding_bottom_mob}}px;
    }
}
.product-video-wrapper {position: relative; width: 100%; overflow: hidden; border-radius:1rem;}
.product-video-wrapper iframe {position: absolute;top: 0;left: 0;width: 100%;height: 100%;border: 0;}
{% endstyle %}

{% if product.metafields.custom.product_video_url != blank %}
  {% assign video_url = product.metafields.custom.product_video_url.value %}

  {% assign ratio_parts = section.settings.video_ratio | split: ":" %}
  {% assign ratio_width = ratio_parts[0] | plus: 0 %}
  {% assign ratio_height = ratio_parts[1] | plus: 0 %}
  {% assign padding_top_ratio = ratio_height | times: 100.0 | divided_by: ratio_width %}


  <div class="section-product-video padding_{{ section.id }}">
    <div class="section">
        <div class="product-video-wrapper" style="padding-top: {{ padding_top_ratio }}%;">
        
        {% if video_url contains 'youtube.com' or video_url contains 'youtu.be' %}
            {% if video_url contains 'youtu.be' %}
            {% assign youtube_id = video_url | split: '/' | last %}
            {% else %}
            {% assign youtube_id = video_url | split: 'v=' | last | split: '&' | first %}
            {% endif %}

            <iframe
            src="https://www.youtube.com/embed/{{ youtube_id }}"
            frameborder="0"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
            allowfullscreen
            ></iframe>

        {% elsif video_url contains 'vimeo.com' %}
            {% assign vimeo_id = video_url | split: '/' | last %}

            <iframe
            src="https://player.vimeo.com/video/{{ vimeo_id }}"
            frameborder="0"
            allow="autoplay; fullscreen"
            allowfullscreen
            ></iframe>
        {% endif %}

        </div>
    </div>
  </div>
{% endif %}


{% schema %}
{
  "name": "Product Video",
  "settings": [
    {
        "type": "header",
        "content": "Video Settings"
    },
    {
      "type": "select",
      "id": "video_ratio",
      "label": "Aspect Ratio",
      "default": "16:9",
      "options": [
        { "value": "16:9", "label": "16:9 (Widescreen)" },
        { "value": "4:3", "label": "4:3 (Classic)" },
        { "value": "1:1", "label": "1:1 (Square)" }
      ]
    },
    {
      "type": "header",
      "content": "Section Padding Desktop"
    },
    {
      "type": "range",
      "id": "padding_top",
      "label": "Padding Top",
      "min": 0,
      "max": 200,
      "step": 2,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "label": "Padding Bottom",
      "min": 0,
      "max": 200,
      "step": 2,
      "unit": "px",
      "default": 0
    },
    {
      "type": "header",
      "content": "Section Padding Mobile"
    },
    {
      "type": "range",
      "id": "padding_top_mob",
      "label": "Padding Top Mobile",
      "min": 0,
      "max": 200,
      "step": 2,
      "unit": "px",
      "default": 0
    },
    {
      "type": "range",
      "id": "padding_bottom_mob",
      "label": "Padding Bottom Mobile",
      "min": 0,
      "max": 200,
      "step": 2,
      "unit": "px",
      "default": 0
    }
  ],
  "presets": [
    {
      "name": "Product Video"
    }
  ]
}
{% endschema %}
